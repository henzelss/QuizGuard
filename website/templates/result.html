{% extends 'dashboard.html '%}

{% block content %}
    <div class="container bg-night rounded p-5">
        
        <div class="accordion" id="accordionResult">
            <div class="accordion-item bg-night">
                <h2 class="accordion-header" id="headingTwo">
                  <button class="accordion-button collapsed bg-night" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <h1>Quiz Result</h1>
                  </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse bg-night" aria-labelledby="headingTwo" data-bs-parent="#accordionResult">
                  <div class="accordion-body bg-night">
                    <table class="table bg-night table-responsive">
                        <thead>
                            <tr>
                                <div class="row">
                                    <div class="col"><h5>Leader Board</h5></div>
                                    <div class="col d-flex justify-content-end"><button class="btn btn-warning d-print-none" >Print PDF</button></div>
                                </div>
                                <th scope="col">Full Name</th>
                                <th scope="col">Score</th>
                            </tr>
                        </thead>
                        <tbody>
                              {% for student in students %}
                                <tr>
                                    <td>{{ student.firstname|title }}&nbsp;{{ student.lastname|title }}</td>
                                    <td>{{ student.score}}/{{total_score}}</td>
                                </tr>
                              {% endfor %}
                        </tbody>
                    </table>
                  </div>
                </div>
            </div>
            <div class="accordion-item bg-night d-print-none">
                <h2 class="accordion-header d-print-none" id="headingViolations ">
                  <button class="accordion-button collapsed bg-night d-print-none" type="button" data-bs-toggle="collapse" data-bs-target="#collapseViolations" aria-expanded="false" aria-controls="collapseViolations">
                    <h1>Quiz Violations</h1>
                  </button>
                </h2>
                <div id="collapseViolations" class="accordion-collapse collapse bg-night d-print-none" aria-labelledby="headingViolations" data-bs-parent="#accordionResult">
                  <div class="accordion-body bg-night d-print-none">
                      <table class="table table-dark table-responsive d-print-none">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Full Name</th>
                                <th>Laptop Detected</th>
                                <th>Phone Detected</th>
                                <th>Head Pose</th>
                                <th>Switch Tabs</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for violation in violations %}
                                <tr>
                                    <td>{{ violation.user_id }}</td>
                                    <td>Full name</td>
                                    <td>{{ violation.detected }}</td>
                                    <td>{{ violation.phone_detected }}</td>
                                    <td>{{ violation.focus }}</td>
                                    <td>{{ violation.switch_tabs }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                      </table>
                  </div>
                </div>
            </div>
        </div>
    </div>

    <script>
      document.querySelector(".btn-warning").addEventListener("click", function() {
      printTable();
    });
    
    function printTable() {
      window.print();
    }
      // prevent users from going back to the test
      // window.history.pushState(null, null, location.href);
      // window.onpopstate = function(event) 
      // {
      //   window.history.pushState(null, null, location.href);
      // };
  </script>
{% endblock %}